const db = require('../config/db');

// Add a new collage
const addCollage = async (data) => {
  const { name, dean, website, universityId } = data;
  const [result] = await db.promise().query(
    `INSERT INTO collages (name, dean, website, uni) VALUES (?, ?, ?, ?)`,
    [name, dean, website, universityId]
  );
  return result;
};

// Delete a collage
const deleteCollage = async (id) => {
  const [result] = await db.promise().query(
    `DELETE FROM collages WHERE id = ?`,
    [id]
  );
  return result;
};

// Get a collage by ID
const getCollageById = async (id) => {
  const [rows] = await db.promise().query(
    `SELECT * FROM collages WHERE id = ?`,
    [id]
  );
  return rows;
};

// Search collages by name
const searchCollagesByName = async (name) => {
  const [rows] = await db.promise().query(
    `SELECT * FROM collages WHERE name LIKE ?`,
    [`%${name}%`]
  );
  return rows;
};
// Update a collage
const updateCollage = async (id, data) => {
    const { name, dean, website, universityId } = data;
    const [result] = await db.promise().query(
      `UPDATE collages 
       SET name = ?, dean = ?, website = ?, uni = ?
       WHERE id = ?`,
      [name, dean, website, universityId, id]
    );
    return result;
  };

module.exports = {
  addCollage,
  deleteCollage,
  getCollageById,
  searchCollagesByName,
  updateCollage,
};
